
 <!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Zombie Battle</title>

<style>
html,body{margin:0;overflow:hidden;background:black;touch-action:none}
canvas{display:block}
#joy{position:fixed;left:20px;bottom:40px;width:140px;height:140px;
background:rgba(0,255,0,.25);border-radius:50%}
#stick{width:60px;height:60px;background:#00ff88;border-radius:50%;
position:absolute;left:40px;top:40px}
#fire{position:fixed;right:30px;bottom:60px;width:90px;height:90px;
border-radius:50%;background:red;color:white;font-size:30px;border:none}
</style>
</head>

<body>
<canvas id="c"></canvas>
<div id="joy"><div id="stick"></div></div>
<button id="fire">ðŸ”¥</button>

<audio id="bgm" src="bg.mp3" loop></audio>
<audio id="fireS" src="fire.mp3"></audio>
<audio id="hitS" src="hit.mp3"></audio>

<script>
const cvs=document.getElementById("c"),ctx=cvs.getContext("2d");
cvs.width=innerWidth;cvs.height=innerHeight;

/* IMAGES */
const bg=new Image();bg.src="bg.png";
const pImg=new Image();pImg.src="player.png";
const zImg=new Image();zImg.src="zombie.png";
const bImg=new Image();bImg.src="boss.png";
const bulletImg=new Image();bulletImg.src="bullet.png";

/* AUDIO */
bgm.volume=.4;bgm.play();

/* GAME DATA */
let cameraX=0,level=1;
let player={x:cvs.width/3,y:cvs.height-200,w:80,h:80,hp:100};
let zombies=[],bullets=[],boss=null;

/* GUNS */
const guns=[
 {name:"Pistol",speed:7,damage:1,size:20},
 {name:"Machine",speed:11,damage:1,size:18},
 {name:"Power",speed:6,damage:3,size:30}
];
let gunIndex=0;

/* JOYSTICK */
let joyX=0,joyY=0,act=false;
joy.ontouchstart=()=>act=true;
joy.ontouchend=()=>{act=false;joyX=joyY=0;stick.style.left="40px";stick.style.top="40px"};
joy.ontouchmove=e=>{
 e.preventDefault();
 let r=joy.getBoundingClientRect();
 let x=e.touches[0].clientX-r.left-70;
 let y=e.touches[0].clientY-r.top-70;
 let d=Math.min(40,Math.hypot(x,y));
 let a=Math.atan2(y,x);
 joyX=Math.cos(a)*d; joyY=Math.sin(a)*d;
 stick.style.left=40+joyX+"px"; stick.style.top=40+joyY+"px";
};

/* FIRE + GUN CHANGE */
let pressT=0;
fire.ontouchstart=()=>{
 pressT=Date.now();
 fireGun();
};
fire.ontouchend=()=>{
 if(Date.now()-pressT>400){
  gunIndex=(gunIndex+1)%guns.length;
 }
};

function fireGun(){
 fireS.currentTime=0;fireS.play();
 let g=guns[gunIndex];
 bullets.push({
  x:cameraX+player.x+player.w,
  y:player.y+player.h/2,
  dx:g.speed, dmg:g.damage, s:g.size
 });
}

/* SPAWN ZOMBIES */
setInterval(()=>{
 zombies.push({
  x:cameraX+cvs.width+200,
  y:cvs.height-200,
  w:70,h:70,
  hp:level, speed:1+level*.5
 });
},2000);

/* LEVEL SYSTEM */
setInterval(()=>{
 level++;
 if(level===3){
  boss={x:cameraX+cvs.width+300,y:cvs.height-240,w:150,h:150,hp:30};
 }
},15000);

/* UPDATE */
function update(){
 if(joyX>10) cameraX+=4;
 player.y+=joyY*.2;
 player.y=Math.max(100,Math.min(player.y,cvs.height-120));

 bullets.forEach(b=>b.x+=b.dx);
 zombies.forEach(z=>z.x-=z.speed);
 if(boss) boss.x-=1;

 zombies.forEach(z=>{
  if(z.x-cameraX<player.x+player.w){
   player.hp-=.3;
  }
 });

 bullets.forEach((b,bi)=>{
  zombies.forEach((z,zi)=>{
   if(b.x<z.x+z.w && b.y<z.y+z.h){
    z.hp-=b.dmg; bullets.splice(bi,1); hitS.play();
    if(z.hp<=0) zombies.splice(zi,1);
   }
  });
  if(boss && b.x<boss.x+boss.w && b.y<boss.y+boss.h){
   boss.hp-=b.dmg; bullets.splice(bi,1); hitS.play();
   if(boss.hp<=0) boss=null;
  }
 });
}

/* DRAW */
function draw(){
 ctx.clearRect(0,0,cvs.width,cvs.height);
 ctx.drawImage(bg,-cameraX%cvs.width,0,cvs.width,cvs.height);
 ctx.drawImage(bg,cvs.width-cameraX%cvs.width,0,cvs.width,cvs.height);

 ctx.fillStyle="white";
 ctx.fillText("LEVEL "+level,20,30);
 ctx.fillText("GUN: "+guns[gunIndex].name,20,50);

 /* HEALTH BAR */
 ctx.fillStyle="red";ctx.fillRect(20,60,120,10);
 ctx.fillStyle="lime";ctx.fillRect(20,60,120*(player.hp/100),10);

 ctx.drawImage(pImg,player.x,player.y,player.w,player.h);

 zombies.forEach(z=>ctx.drawImage(zImg,z.x-cameraX,z.y,z.w,z.h));
 if(boss){
  ctx.drawImage(bImg,boss.x-cameraX,boss.y,boss.w,boss.h);
  ctx.fillStyle="red";
  ctx.fillRect(cvs.width/2-60,20,120*(boss.hp/30),10);
 }

 bullets.forEach(b=>{
  ctx.drawImage(bulletImg,b.x-cameraX,b.y,b.s,b.s);
 });
}

function loop(){update();draw();requestAnimationFrame(loop)}
loop();
</script>
</body>
</html>
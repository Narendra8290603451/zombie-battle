<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0,user-scalable=no">
<title>Zombie Battle</title>

<style>
html,body{
 margin:0;
 padding:0;
 overflow:hidden;
 background:black;
}
canvas{
 display:block;
 touch-action:none;
}
#ui{
 position:fixed;
 top:5px;
 width:100%;
 color:white;
 text-align:center;
 font-family:Arial;
 z-index:10;
}
.btn{
 position:fixed;
 width:60px;
 height:60px;
 background:#00ff99;
 color:black;
 font-size:22px;
 border-radius:10px;
 display:flex;
 align-items:center;
 justify-content:center;
 user-select:none;
}
#up{left:20px;bottom:140px}
#down{left:20px;bottom:20px}
#fire{right:20px;bottom:60px;background:red;color:white}
</style>
</head>

<body>

<div id="ui">Gun: Pistol | Level: 1 | Score: 0</div>
<canvas id="game"></canvas>

<div id="up" class="btn">â†‘</div>
<div id="down" class="btn">â†“</div>
<div id="fire" class="btn">ðŸ”¥</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

function resize(){
 canvas.width=innerWidth;
 canvas.height=innerHeight;
}
resize();
addEventListener("resize",resize);

// ðŸ”Š Sounds
const bgm=new Audio("bg.mp3"); bgm.loop=true; bgm.volume=0.4;
const fireSound=new Audio("fire.mp3");
const hitSound=new Audio("hit.mp3");

// ðŸ–¼ Images
const bg=new Image(); bg.src="bg.png";
const playerImg=new Image(); playerImg.src="player.png";
const zombieImg=new Image(); zombieImg.src="zombie.png";
const bossImg=new Image(); bossImg.src="boss.png";
const bulletImg=new Image(); bulletImg.src="bullet.png";

// ðŸŽ® Game data
let worldY=0,score=0,level=1;
const player={w:90,h:110,x:0,y:0};
const bullets=[];
const zombies=[];
let boss=null;

// ðŸ”« Guns
const guns=[
 {name:"Pistol",speed:8,damage:1},
 {name:"Rifle",speed:12,damage:2},
 {name:"Shotgun",speed:6,damage:3}
];
let gunIndex=0;

// ðŸŽ¯ Controls
let up=false,down=false;

document.getElementById("up").ontouchstart=()=>up=true;
document.getElementById("up").ontouchend=()=>up=false;
document.getElementById("down").ontouchstart=()=>down=true;
document.getElementById("down").ontouchend=()=>down=false;

document.getElementById("fire").ontouchstart=shoot;

document.addEventListener("click",()=>bgm.play(),{once:true});

// ðŸ”« Shoot
function shoot(){
 fireSound.currentTime=0;
 fireSound.play();
 bullets.push({
  x:player.x+player.w/2-20,
  y:player.y,
  w:40,h:40,
  speed:guns[gunIndex].speed,
  dmg:guns[gunIndex].damage
 });
}

// ðŸ§Ÿ Spawn zombies
function spawnZombie(){
 zombies.push({
  x:Math.random()*(canvas.width-80),
  y:-worldY-100,
  w:90,h:110,
  hp:2+level
 });
}

// ðŸ‘¹ Boss
function spawnBoss(){
 boss={
  x:canvas.width/2-150,
  y:-worldY-400,
  w:300,h:300,
  hp:30+level*10
 };
}

// ðŸ” Loop
function update(){
 ctx.clearRect(0,0,canvas.width,canvas.height);

 // scroll
 if(up) worldY+=4;
 if(down) worldY-=4;

 // background
 ctx.drawImage(bg,0,worldY%canvas.height,canvas.width,canvas.height);
 ctx.drawImage(bg,0,worldY%canvas.height-canvas.height,canvas.width,canvas.height);

 // player fixed
 player.x=canvas.width/2-player.w/2;
 player.y=canvas.height-player.h-40;
 ctx.drawImage(playerImg,player.x,player.y,player.w,player.h);

 // bullets
 bullets.forEach((b,i)=>{
  b.y-=b.speed;
  ctx.drawImage(bulletImg,b.x,b.y,b.w,b.h);
  zombies.forEach((z,zi)=>{
   if(b.x<z.x+z.w && b.x+b.w>z.x && b.y<z.y+worldY+z.h && b.y+b.h>z.y+worldY){
    z.hp-=b.dmg;
    bullets.splice(i,1);
    hitSound.play();
    if(z.hp<=0){zombies.splice(zi,1);score+=10;}
   }
  });
  if(boss && b.x<boss.x+boss.w && b.x+b.w>boss.x && b.y<boss.y+worldY+boss.h && b.y+b.h>boss.y+worldY){
   boss.hp-=b.dmg;
   bullets.splice(i,1);
   hitSound.play();
   if(boss.hp<=0){boss=null;level++;gunIndex=(gunIndex+1)%guns.length;}
  }
 });

 // zombies
 zombies.forEach(z=>{
  ctx.drawImage(zombieImg,z.x,z.y+worldY,z.w,z.h);
 });

 // boss
 if(boss){
  ctx.drawImage(bossImg,boss.x,boss.y+worldY,boss.w,boss.h);
 }

 document.getElementById("ui").innerText=
 `Gun: ${guns[gunIndex].name} | Level: ${level} | Score: ${score}`;

 requestAnimationFrame(update);
}

// spawn logic
setInterval(spawnZombie,1200);
setInterval(()=>{if(level%3==0 && !boss) spawnBoss();},3000);

update();
screen.orientation?.lock("landscape").catch(()=>{});
</script>

</body>
</html>